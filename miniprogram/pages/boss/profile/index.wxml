<!-- è€æ¿ç«¯ - æˆ‘çš„ -->
<view class="page">
  <!-- èƒŒæ™¯è£…é¥° -->
  <view class="bg-decorations">
    <!-- æ—‹è½¬é›ªèŠ± -->
    <text class="rotating-snow snow-1">â„ï¸</text>
    <text class="rotating-snow snow-2">â„ï¸</text>
    <text class="rotating-snow snow-3">â„ï¸</text>
    <text class="rotating-snow snow-4">â„ï¸</text>
    <!-- é™æ€åœ£è¯æ ‘ -->
    <text class="christmas-tree tree-1">ğŸ„</text>
    <text class="christmas-tree tree-2">ğŸ„</text>
    <text class="christmas-tree tree-3">ğŸ„</text>
  </view>

  <!-- åˆ·æ–°æŒ‰é’® -->
  <view class="refresh-btn" bindtap="onRefresh">â†»</view>

  <!-- æ–°è®¢å•æé†’ -->
  <view class="order-notification" wx:if="{{pendingOrderCount > 0}}" bindtap="onOrderNotificationTap">
    <view class="notification-content">
      <text class="notification-text">æ‚¨æœ‰ {{pendingOrderCount}} ä¸ªæ–°è®¢å•å¾…å¤„ç†</text>
    </view>
    <text class="notification-arrow">â€º</text>
  </view>

  <!-- é›ªèŠ±å®¹å™¨ -->
  <view class="snow-container" wx:if="{{showSnow}}">
    <view wx:for="{{snowflakes}}" wx:key="id"
          class="snowflake"
          style="left: {{item.left}}px; animation-duration: {{item.duration}}s; animation-delay: {{item.delay}}s;">
      â„
    </view>
  </view>

  <scroll-view scroll-y="{{true}}" class="scroll-content">
    <!-- é¡¶éƒ¨ç”¨æˆ·ä¿¡æ¯åŒºåŸŸ -->
    <view class="user-header-section">
      <view class="user-avatar-container" wx:if="{{!loading}}">
        <view class="user-avatar">
          <image wx:if="{{userInfo.avatar}}" src="{{userInfo.avatar}}" mode="aspectFill" class="avatar-image" />
          <text wx:else class="avatar-text">è€æ¿</text>
        </view>
      </view>
      <view class="user-info-container" wx:if="{{!loading}}">
        <view class="user-name-row">
          <text class="user-name">{{userInfo.nickname || 'æœªè®¾ç½®æ˜µç§°'}}</text>
          <view class="vip-badge" wx:if="{{userInfo.vipLevel}}">{{userInfo.vipLevel}}</view>
        </view>
        <text class="user-id">ID: {{userInfo.userId || 'æœªè®¾ç½®'}}</text>
      </view>
    </view>
    <!-- é’±åŒ…ä¿¡æ¯ -->
    <view class="wallet-info-card" wx:if="{{!loading}}">
      <view class="wallet-info">
        <view class="wallet-content">
          <view class="wallet-details">
            <view class="wallet-title">é’±åŒ…ä½™é¢</view>
            <view class="wallet-balance">Â¥{{walletInfo.balance}}</view>
          </view>
        </view>
        <view class="wallet-divider"></view>
        <view class="wallet-content">
          <view class="wallet-details">
            <view class="wallet-title">æ¶ˆè´¹æ€»é¢</view>
            <view class="wallet-balance">Â¥{{totalConsumption}}</view>
          </view>
        </view>
      </view>
    </view>

    <!-- VIP ä¿¡æ¯ -->
    <view class="vip-info-card" wx:if="{{!loading}}" bindtap="onVipTap">
      <view class="vip-info">
        <view class="vip-content">
          <view class="vip-details">
            <view class="vip-title">å°Šè´µVIPä¼šå‘˜</view>
            <view class="vip-desc">äº«å—ä¸“å±ç‰¹æƒ</view>
          </view>
        </view>
        <text class="arrow">â€º</text>
      </view>
    </view>

    <!-- æˆ‘çš„ç›´å±å‘˜å·¥ -->
    <view class="staff-section surface">
      <view class="section-header">
        <text class="section-title">æˆ‘çš„ç›´å±å‘˜å·¥</text>
      </view>
      <scroll-view scroll-x="{{true}}" class="staff-scroll">
        <view class="staff-item" wx:for="{{myStaffs}}" wx:key="_openid">
          <view class="staff-avatar-small">
            <image wx:if="{{item.avatar}}" src="{{item.avatar}}" mode="aspectFill" class="avatar-image-small" />
            <text wx:else class="staff-text-small">å‘˜</text>
          </view>
          <text class="staff-name-small">{{item.nickname}}</text>
        </view>
      </scroll-view>
    </view>

    <!-- ä¸»çº¿æ•…äº‹ -->
    <view class="story-section surface" wx:if="{{!loading}}">
      <view class="section-header">
        <text class="section-title">ä¸»çº¿æ•…äº‹</text>
      </view>
      <view class="story-content">
        <view class="story-text">{{storyContent}}</view>
        <view class="story-level">å½“å‰ç­‰çº§ï¼š{{currentLevelName}}</view>
      </view>
    </view>

    <!-- èœå•åˆ—è¡¨ -->
    <view class="menu-section surface">
      <view class="menu-item" wx:for="{{menuList}}" wx:key="id" data-action="{{item.action}}" bindtap="onMenuTap">
        <view class="menu-icon" style="background: {{item.bgColor}};">
          <text class="icon-emoji">{{item.icon}}</text>
        </view>
        <view class="menu-info">
          <view class="menu-title">{{item.title}}</view>
          <view class="menu-desc">{{item.desc}}</view>
        </view>
        <text class="arrow">â€º</text>
      </view>
    </view>

    <view class="bottom-spacer"></view>
  </scroll-view>
</view>
