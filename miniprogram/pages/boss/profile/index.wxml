<!-- 老板端 - 我的 -->
<view class="page">
  <!-- 全局雪花效果 -->
  <global-snow></global-snow>

  <!-- 刷新按钮 -->
  <view class="refresh-btn" bindtap="onRefresh">↻</view>

  <!-- 新订单提醒 -->
  <view class="order-notification" wx:if="{{pendingOrderCount > 0}}" bindtap="onOrderNotificationTap">
    <view class="notification-content">
      <text class="notification-text">您有 {{pendingOrderCount}} 个新订单待处理</text>
    </view>
    <text class="notification-arrow">›</text>
  </view>

  <!-- 雪花容器 -->
  <view class="snow-container" wx:if="{{showSnow}}">
    <view wx:for="{{snowflakes}}" wx:key="id"
          class="snowflake"
          style="left: {{item.left}}px; animation-duration: {{item.duration}}s; animation-delay: {{item.delay}}s;">
      ❄
    </view>
  </view>

  <scroll-view scroll-y="{{true}}" class="scroll-content">
    <!-- 顶部用户信息区域 -->
    <view class="user-header-section">
      <view class="user-avatar-container" wx:if="{{!loading}}">
        <view class="user-avatar">
          <image wx:if="{{userInfo.avatar}}" src="{{userInfo.avatar}}" mode="aspectFill" class="avatar-image" />
          <text wx:else class="avatar-text">老板</text>
        </view>
      </view>
      <view class="user-info-container" wx:if="{{!loading}}">
        <view class="user-name-row">
          <text class="user-name">{{userInfo.nickname || '未设置昵称'}}</text>
          <view class="vip-badge" wx:if="{{userInfo.vipLevel}}">{{userInfo.vipLevel}}</view>
        </view>
        <text class="user-id">ID: {{userInfo.userId || '未设置'}}</text>
      </view>
    </view>
    <!-- 钱包信息 -->
    <view class="wallet-info-card" wx:if="{{!loading}}">
      <view class="wallet-info">
        <view class="wallet-content">
          <view class="wallet-details">
            <view class="wallet-title">钱包余额</view>
            <view class="wallet-balance">¥{{walletInfo.balance}}</view>
          </view>
        </view>
        <view class="wallet-divider"></view>
        <view class="wallet-content">
          <view class="wallet-details">
            <view class="wallet-title">消费总额</view>
            <view class="wallet-balance">¥{{totalConsumption}}</view>
          </view>
        </view>
      </view>
    </view>

    <!-- VIP 信息 -->
    <view class="vip-info-card" wx:if="{{!loading}}" bindtap="onVipTap">
      <view class="vip-info">
        <view class="vip-content">
          <view class="vip-details">
            <view class="vip-title">尊贵VIP会员</view>
            <view class="vip-desc">享受专属特权</view>
          </view>
        </view>
        <text class="arrow">›</text>
      </view>
    </view>

    <!-- 我的直属员工 -->
    <view class="staff-section surface">
      <view class="section-header">
        <text class="section-title">我的直属员工</text>
      </view>
      <scroll-view scroll-x="{{true}}" class="staff-scroll">
        <view class="staff-item" wx:for="{{myStaffs}}" wx:key="_openid">
          <view class="staff-avatar-small">
            <image wx:if="{{item.avatar}}" src="{{item.avatar}}" mode="aspectFill" class="avatar-image-small" />
            <text wx:else class="staff-text-small">员</text>
          </view>
          <text class="staff-name-small">{{item.nickname}}</text>
        </view>
      </scroll-view>
    </view>

    <!-- 主线故事 -->
    <view class="story-section surface" wx:if="{{!loading}}">
      <view class="section-header">
        <text class="section-title">主线故事</text>
      </view>
      <view class="story-content">
        <view class="story-text">{{storyContent}}</view>
        <view class="story-level">当前等级：{{currentLevelName}}</view>
      </view>
    </view>

    <!-- 菜单列表 -->
    <view class="menu-section surface">
      <view class="menu-item" wx:for="{{menuList}}" wx:key="id" data-action="{{item.action}}" bindtap="onMenuTap">
        <view class="menu-icon" style="background: {{item.bgColor}};">
          <text class="icon-emoji">{{item.icon}}</text>
        </view>
        <view class="menu-info">
          <view class="menu-title">{{item.title}}</view>
          <view class="menu-desc">{{item.desc}}</view>
        </view>
        <text class="arrow">›</text>
      </view>
    </view>

    <view class="bottom-spacer"></view>
  </scroll-view>
</view>
