<!-- å‘˜å·¥ç«¯ - æ’è¡Œæ¦œ -->
<view class="page">
  <!-- é¡¶éƒ¨å¯¼èˆª -->
  <view class="header">
    <view class="back-btn" bindtap="onBack">â€¹</view>
    <view class="header-title">æ’è¡Œæ¦œ</view>
  </view>

  <!-- æ’è¡Œæ¦œç±»å‹åˆ‡æ¢ - ä½¿ç”¨æ ‡ç­¾é¡µæ ·å¼ -->
  <view class="tab-switch">
    <view class="tab-item {{rankingType === 'staff' ? 'active' : ''}}" data-type="staff" bindtap="switchRankingType">
      å‘˜å·¥æ’è¡Œ
    </view>
    <view class="tab-item {{rankingType === 'subordinate' ? 'active' : ''}}" data-type="subordinate" bindtap="switchRankingType">
      ç›´å±æ’è¡Œ
    </view>
  </view>

  <!-- æ—¶é—´å‘¨æœŸé€‰æ‹© -->
  <view class="period-switch">
    <view class="period-item {{periodType === 'day' ? 'active' : ''}}" data-period="day" bindtap="switchPeriod">æ—¥æµæ°´ ({{todayLabel}})</view>
    <view class="period-item {{periodType === 'month' ? 'active' : ''}}" data-period="month" bindtap="switchPeriod">æœˆæµæ°´ ({{monthLabel}})</view>
    <view class="period-item {{periodType === 'total' ? 'active' : ''}}" data-period="total" bindtap="switchPeriod">æ€»æµæ°´</view>
  </view>

  <!-- æ ‡é¢˜åŒºåŸŸ -->
  <view class="title-section">
    <text class="title-text">{{rankingType === 'staff' ? 'ğŸ† ä¸ªäººæµæ°´æ’è¡Œæ¦œ' : 'ğŸ‘‘ ç›´å±æµæ°´æ’è¡Œæ¦œ'}}</text>
    <text class="subtitle">{{rankingType === 'staff' ? 'æŒ‰ä¸ªäººæµæ°´æ’å' : 'æŒ‰ç›´å±æµæ°´æ’å'}}</text>
  </view>

  <scroll-view scroll-y="{{true}}" class="scroll-content">
    <!-- åŠ è½½çŠ¶æ€ -->
    <view class="loading-state" wx:if="{{loading}}">
      <view class="loading-text">åŠ è½½ä¸­...</view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:elif="{{rankings.length === 0}}">
      <view class="empty-icon">ğŸ“Š</view>
      <view class="empty-text">æš‚æ— å‘˜å·¥æ•°æ®</view>
      <view class="empty-desc">è¯·è”ç³»ç®¡ç†å‘˜æ·»åŠ å‘˜å·¥ä¿¡æ¯</view>
    </view>

    <!-- æ’ååˆ—è¡¨ -->
    <view class="ranking-section" wx:else>
      <view class="section-title">
        <text class="title-icon">{{rankingType === 'staff' ? 'ğŸ†' : 'ğŸ‘‘'}}</text>
        <text class="title-text">{{rankingType === 'staff' ? 'ä¸ªäººæµæ°´æ’è¡Œæ¦œ' : 'ç›´å±æµæ°´æ’è¡Œæ¦œ'}}</text>
      </view>

      <!-- å‰ä¸‰åç‰¹æ®Šå±•ç¤º -->
      <view class="top-three-section" wx:if="{{rankings.length >= 3}}">
        <view class="top-three">
          <!-- ç¬¬äºŒå -->
          <view class="top-item top-2" wx:if="{{rankings[1]}}">
            <view class="top-avatar">
              <image wx:if="{{rankings[1].userInfo && rankings[1].userInfo.avatar}}" src="{{rankings[1].userInfo.avatar}}" mode="aspectFill" class="avatar-image" />
              <text wx:else class="avatar-emoji">ğŸ¥ˆ</text>
              <view class="rank-badge badge-2">2</view>
            </view>
            <text class="top-name">{{rankings[1].userInfo.nickname}}</text>
            <text class="top-orders highlight">Â¥{{rankingType === 'staff' ? (rankings[1].totalRevenueDisplay || '0.00') : (rankings[1].subordinateRevenueDisplay || '0.00')}}</text>
          </view>

          <!-- ç¬¬ä¸€å -->
          <view class="top-item top-1" wx:if="{{rankings[0]}}">
            <view class="top-avatar top-1-avatar">
              <image wx:if="{{rankings[0].userInfo && rankings[0].userInfo.avatar}}" src="{{rankings[0].userInfo.avatar}}" mode="aspectFill" class="avatar-image" />
              <text wx:else class="avatar-emoji">ğŸ¥‡</text>
              <view class="rank-badge badge-1">1</view>
            </view>
            <text class="top-name">{{rankings[0].userInfo.nickname}}</text>
            <text class="top-orders highlight">Â¥{{rankingType === 'staff' ? (rankings[0].totalRevenueDisplay || '0.00') : (rankings[0].subordinateRevenueDisplay || '0.00')}}</text>
          </view>

          <!-- ç¬¬ä¸‰å -->
          <view class="top-item top-3" wx:if="{{rankings[2]}}">
            <view class="top-avatar">
              <image wx:if="{{rankings[2].userInfo && rankings[2].userInfo.avatar}}" src="{{rankings[2].userInfo.avatar}}" mode="aspectFill" class="avatar-image" />
              <text wx:else class="avatar-emoji">ğŸ¥‰</text>
              <view class="rank-badge badge-3">3</view>
            </view>
            <text class="top-name">{{rankings[2].userInfo.nickname}}</text>
            <text class="top-orders highlight">Â¥{{rankingType === 'staff' ? (rankings[2].totalRevenueDisplay || '0.00') : (rankings[2].subordinateRevenueDisplay || '0.00')}}</text>
          </view>
        </view>
      </view>

      <!-- å®Œæ•´æ’ååˆ—è¡¨ -->
      <view class="ranking-list">
        <view class="ranking-item {{item.rank <= 3 ? 'top-rank' : ''}}" wx:for="{{rankings}}" wx:key="rank">
          <view class="rank-number {{getRankClass(item.rank)}}">
            <text>{{item.rank}}</text>
          </view>
          <view class="staff-avatar">
            <image wx:if="{{item.userInfo && item.userInfo.avatar}}" src="{{item.userInfo.avatar}}" mode="aspectFill" class="avatar-image" />
            <view wx:else class="avatar-placeholder">
              <text class="avatar-emoji">ğŸ‘¤</text>
            </view>
          </view>
          <view class="staff-info">
            <text class="staff-name">{{item.userInfo.nickname}}</text>
            <text class="staff-id">ID: {{item.userInfo.userId}}</text>
          </view>
          <view class="staff-stats">
            <text class="stat-orders">Â¥{{rankingType === 'staff' ? (item.totalRevenueDisplay || '0.00') : (item.subordinateRevenueDisplay || '0.00')}}</text>
          </view>
        </view>
      </view>
    </view>

    <view class="bottom-spacer"></view>
  </scroll-view>

  <!-- è‡ªå®šä¹‰TabBar -->
  <custom-tab-bar />
</view>
