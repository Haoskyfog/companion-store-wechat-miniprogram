<view class="container">
  <!-- ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ -->
  <view class="user-card" wx:if="{{!loading}}">
    <view class="user-info">
      <image class="avatar" src="{{userInfo.avatar || '/assets/default-avatar.png'}}" mode="aspectFill" wx:if="{{userInfo.avatar}}"></image>
      <view class="default-avatar" wx:else>{{userInfo.nickname.charAt(0)}}</view>
      <view class="user-details">
        <text class="nickname">{{userInfo.nickname}}</text>
        <text class="user-id">ID: {{userInfo.userId}}</text>
      </view>
    </view>
  </view>

  <!-- ç»Ÿè®¡å¡ç‰‡ -->
  <view class="stats-section" wx:if="{{!loading}}">
    <!-- è®¢å•ç»Ÿè®¡ -->
    <view class="stat-card">
      <view class="card-header">
        <text class="card-icon">ğŸ“‹</text>
        <text class="card-title">è®¢å•ç»Ÿè®¡</text>
      </view>
      <view class="card-content">
        <view class="stat-grid">
          <view class="stat-item">
            <text class="stat-value">{{statistics.orders.total}}</text>
            <text class="stat-label">æ€»è®¢å•</text>
          </view>
          <view class="stat-item">
            <text class="stat-value pending">{{statistics.orders.pending}}</text>
            <text class="stat-label">å¾…ç¡®è®¤</text>
          </view>
          <view class="stat-item">
            <text class="stat-value confirmed">{{statistics.orders.confirmed}}</text>
            <text class="stat-label">å·²ç¡®è®¤</text>
          </view>
          <view class="stat-item">
            <text class="stat-value completed">{{statistics.orders.completed}}</text>
            <text class="stat-label">å·²å®Œæˆ</text>
          </view>
        </view>

        <view class="stat-extra">
          <view class="extra-item">
            <text class="extra-label">æ€»æœåŠ¡æ—¶é•¿</text>
            <text class="extra-value">{{formatDuration(statistics.orders.totalDuration)}}</text>
          </view>
          <view class="extra-item">
            <text class="extra-label">å®Œæˆç‡</text>
            <text class="extra-value success">{{getCompletionRate()}}</text>
          </view>
          <view class="extra-item">
            <text class="extra-label">å¹³å‡æ—¶é•¿</text>
            <text class="extra-value">{{getAverageDuration()}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- æŠ¥å¤‡ç»Ÿè®¡ -->
    <view class="stat-card">
      <view class="card-header">
        <text class="card-icon">ğŸ“</text>
        <text class="card-title">æŠ¥å¤‡ç»Ÿè®¡</text>
      </view>
      <view class="card-content">
        <view class="stat-grid">
          <view class="stat-item">
            <text class="stat-value">{{statistics.reports.total}}</text>
            <text class="stat-label">æ€»æŠ¥å¤‡</text>
          </view>
          <view class="stat-item">
            <text class="stat-value pending">{{statistics.reports.pending}}</text>
            <text class="stat-label">å¾…å®¡æ ¸</text>
          </view>
          <view class="stat-item">
            <text class="stat-value approved">{{statistics.reports.approved}}</text>
            <text class="stat-label">å·²é€šè¿‡</text>
          </view>
        </view>

        <view class="stat-extra">
          <view class="extra-item">
            <text class="extra-label">å®¡æ ¸é€šè¿‡ç‡</text>
            <text class="extra-value success">
              {{statistics.reports.total > 0 ? Math.round((statistics.reports.approved / statistics.reports.total) * 100) + '%' : '0%'}}
            </text>
          </view>
        </view>
      </view>
    </view>

    <!-- è¿›åº¦æ¡ -->
    <view class="progress-card">
      <view class="progress-header">
        <text class="progress-title">æœ¬æœˆç›®æ ‡è¿›åº¦</text>
        <text class="progress-percent">{{getCompletionRate()}}</text>
      </view>
      <view class="progress-bar">
        <view class="progress-fill" style="width: {{getCompletionRate()}};"></view>
      </view>
      <view class="progress-desc">
        <text>å·²å®Œæˆ {{statistics.orders.completed}} ä¸ªè®¢å•</text>
      </view>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading" wx:if="{{loading}}">
    <text>åŠ è½½ä¸­...</text>
  </view>
</view>