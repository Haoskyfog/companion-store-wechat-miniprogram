<!-- ç®¡ç†å‘˜ç«¯ - è®¢å•ç®¡ç† -->
<view class="page">
  <!-- ç­›é€‰æ  -->
  <view class="filter-bar">
    <!-- æ”¯ä»˜çŠ¶æ€ç­›é€‰ -->
    <view class="filter-section">
      <text class="filter-label">è®¢å•çŠ¶æ€:</text>
      <scroll-view scroll-x="{{true}}" class="filter-scroll">
        <view class="filter-btn {{!paymentFilter ? 'active' : ''}}" bindtap="onPaymentFilter" data-payment="">å…¨éƒ¨</view>
        <view class="filter-btn {{paymentFilter === 'paid' ? 'active' : ''}}" bindtap="onPaymentFilter" data-payment="paid">å·²æ”¯ä»˜</view>
        <view class="filter-btn {{paymentFilter === 'cancelled' ? 'active' : ''}}" bindtap="onPaymentFilter" data-payment="cancelled">å·²å–æ¶ˆ</view>
      </scroll-view>
    </view>
  </view>

  <!-- è®¢å•åˆ—è¡¨ -->
  <view class="order-list" wx:if="{{!loading}}">
    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{orders.length === 0}}">
      <view class="empty-icon">ğŸ“‹</view>
      <view class="empty-text">æš‚æ— è®¢å•è®°å½•</view>
    </view>

    <!-- è®¢å•é¡¹ -->
    <view class="order-item" wx:for="{{orders}}" wx:key="_id">
      <view class="order-header">
        <view class="user-info">
          <view class="user-details">
            <text class="user-name">è€æ¿: {{item.bossInfo.nickname}} | å‘˜å·¥: {{item.staffInfo.nickname}}</text>
            <text class="user-ids">ID: {{item.bossInfo.userId}} | {{item.staffInfo.userId}}</text>
          </view>
        </view>
        <view class="order-badges">
          <view class="status-badge {{getStatusClass(item.status)}}">
            {{getStatusText(item.status)}}
          </view>
          <view class="payment-badge {{getPaymentStatusClass(item.paymentStatus)}}">
            {{getPaymentStatusText(item.paymentStatus)}}
          </view>
          <view class="complaint-badge {{getComplaintStatusClass(item.complaintStatus)}}" wx:if="{{item.complaintStatus !== 'none'}}">
            {{getComplaintStatusText(item.complaintStatus)}}
          </view>
        </view>
      </view>

      <view class="order-content">
        <view class="order-info">
          <view class="info-row">
            <text class="info-label">æ¸¸æˆ:</text>
            <text class="info-value">{{item.game}}</text>
          </view>
          <view class="info-row">
            <text class="info-label">æ—¶é•¿:</text>
            <text class="info-value">{{item.duration}}å°æ—¶</text>
          </view>
          <view class="info-row">
            <text class="info-label">é‡‘é¢:</text>
            <text class="info-value amount-value">Â¥{{item.amount}}</text>
          </view>
          <view class="info-row">
            <text class="info-label">æ—¥æœŸ:</text>
            <text class="info-value">{{item.date}}</text>
          </view>
          <view class="info-row" wx:if="{{item.remark}}">
            <text class="info-label">å¤‡æ³¨:</text>
            <text class="info-value">{{item.remark}}</text>
          </view>
          <view class="info-row" wx:if="{{item.complaintReason}}">
            <text class="info-label">å®¢è¯‰åŸå› :</text>
            <text class="info-value complaint-reason">{{item.complaintReason}}</text>
          </view>
        </view>
      </view>

      <view class="order-time">
        <text>{{item.createTime}}</text>
      </view>

      <!-- å®¢è¯‰å¤„ç†æŒ‰é’® -->
      <view class="order-actions" wx:if="{{item.complaintStatus === 'processing'}}">
        <button class="action-btn resolve-btn"
                data-order-id="{{item._id}}"
                bindtap="onHandleComplaint">
          å¤„ç†å®¢è¯‰
        </button>
      </view>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-state" wx:if="{{loading}}">
    <view class="loading-text">åŠ è½½ä¸­...</view>
  </view>
</view>
