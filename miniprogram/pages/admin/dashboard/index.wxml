<!-- ç®¡ç†å‘˜ç«¯ - ä»ªè¡¨æ¿ -->
<view class="page">
  <!-- é¡¶éƒ¨å¯¼èˆª -->
  <view class="header">
    <view class="header-info">
      <text class="header-title">ç®¡ç†åå°</text>
      <text class="header-subtitle">æ¬¢è¿å›æ¥ï¼Œç®¡ç†å‘˜</text>
    </view>
    <view class="header-actions">
      <view class="admin-badge">Admin</view>
      <view class="refresh-btn" bindtap="onRefresh">ğŸ”„</view>
      <text class="icon-btn">ğŸ””</text>
    </view>
  </view>

  <!-- å¿«é€Ÿç»Ÿè®¡ -->
  <view class="stats-grid" wx:if="{{!loading}}">
    <view class="stat-item stat-blue">
      <text class="stat-value">{{statistics.users.total}}</text>
      <text class="stat-label">æ€»ç”¨æˆ·</text>
    </view>
    <view class="stat-item stat-green">
      <text class="stat-value">{{statistics.users.staff}}</text>
      <text class="stat-label">å‘˜å·¥</text>
    </view>
    <view class="stat-item stat-purple">
      <text class="stat-value">{{statistics.users.boss}}</text>
      <text class="stat-label">è€æ¿</text>
    </view>
    <view class="stat-item stat-orange">
      <text class="stat-value">{{statistics.bindings.active}}</text>
      <text class="stat-label">ç»‘å®šå…³ç³»</text>
    </view>
    <view class="stat-item stat-red">
      <text class="stat-value">{{statistics.orders.total}}</text>
      <text class="stat-label">æ€»è®¢å•</text>
    </view>
    <view class="stat-item stat-yellow">
      <text class="stat-value">{{statistics.reports.pending + statistics.requests.pending}}</text>
      <text class="stat-label">å¾…å®¡æ ¸</text>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-state" wx:if="{{loading}}">
    <view class="loading-text">åŠ è½½ä¸­...</view>
  </view>

  <!-- å¾…åŠæé†’ -->
  <view class="todo-card" wx:if="{{!loading && (statistics.reports.pending + statistics.requests.pending) > 0}}" bindtap="onFunctionTap" data-action="audit">
    <view class="todo-content">
      <text class="todo-icon">âš ï¸</text>
      <view class="todo-info">
        <text class="todo-title">æœ‰ {{statistics.reports.pending + statistics.requests.pending}} æ¡å¾…å®¡æ ¸</text>
        <text class="todo-desc">{{statistics.reports.pending}}æ¡æŠ¥å¤‡ + {{statistics.requests.pending}}æ¡æ›´æ¢ç”³è¯·</text>
      </view>
    </view>
    <text class="arrow">â€º</text>
  </view>

  <scroll-view scroll-y="{{true}}" class="scroll-content">
    <!-- å¿«æ·åŠŸèƒ½ -->
    <view class="quick-functions">
      <text class="section-title">å¿«æ·åŠŸèƒ½</text>
      <view class="functions-grid">
        <view class="function-item" wx:for="{{functions}}" wx:key="id" data-action="{{item.action}}" bindtap="onFunctionTap">
          <view class="function-icon" style="background: {{item.bgColor}};">
            <text class="icon-emoji">{{item.icon}}</text>
          </view>
          <text class="function-label">{{item.label}}</text>
          <text class="function-desc">{{item.desc}}</text>
        </view>
      </view>
    </view>


    <!-- æ ¸å¿ƒæ•°æ® -->
    <view class="core-stats">
      <text class="section-title">æ ¸å¿ƒæ•°æ®</text>
      <view class="stats-card">
        <view class="stat-box">
          <text class="stat-big-value purple">{{statistics.orders.total}}</text>
          <text class="stat-big-label">æ€»è®¢å•</text>
          <text class="stat-trend">ğŸ“Š å®æ—¶ç»Ÿè®¡</text>
        </view>
        <view class="stat-box">
          <text class="stat-big-value green">Â¥{{statistics.revenue.totalDisplay}}</text>
          <text class="stat-big-label">æ€»æµæ°´</text>
          <text class="stat-trend">å·²å®¡æ ¸é€šè¿‡æŠ¥å¤‡é‡‘é¢æ€»å’Œ</text>
        </view>
      </view>
      <view class="stats-card">
        <view class="stat-box">
          <text class="stat-big-value orange">Â¥{{statistics.revenue.dayTotalDisplay}}</text>
          <text class="stat-big-label">æ—¥æµæ°´ ({{todayLabel}})</text>
          <text class="stat-trend">ä»Šæ—¥å®¡æ ¸é€šè¿‡æŠ¥å¤‡é‡‘é¢</text>
        </view>
        <view class="stat-box">
          <text class="stat-big-value blue">Â¥{{statistics.revenue.monthTotalDisplay}}</text>
          <text class="stat-big-label">æœˆæµæ°´ ({{monthLabel}})</text>
          <text class="stat-trend">æœ¬æœˆå®¡æ ¸é€šè¿‡æŠ¥å¤‡é‡‘é¢</text>
        </view>
      </view>
    </view>

    <!-- å¼€å‘è€…ä¿¡æ¯ -->
    <view class="developer-card" wx:if="{{developerInfo}}">
      <view class="dev-avatar">
        <image wx:if="{{developerInfo.avatar}}" src="{{developerInfo.avatar}}" mode="aspectFill" class="dev-avatar-img" />
      </view>
      <view class="dev-info">
        <view class="dev-title">å¼€å‘è€…ï¼š{{developerInfo.nickname || developerInfo.userId}}</view>
        <view class="dev-contact">å¾®ä¿¡å·ï¼šfoggy_dream77</view>
        <view class="dev-contact">é‚®ç®±ï¼šlostinskyfog.dev@gmail.com</view>
      </view>
      <view class="dev-tip-btn" bindtap="showTipQrcode">æ‰“èµ</view>
    </view>
    <view class="dev-thanks">åˆ¶ä½œä¸æ˜“ï¼Œæ„Ÿè°¢æ”¯æŒ â™¥</view>

    <!-- æ‰“èµå¼¹çª— -->
    <view class="tip-popup-mask" wx:if="{{showTipPopup}}" bindtap="closeTipPopup">
      <view class="tip-popup" catchtap="">
        <view class="tip-header">æ„Ÿè°¢æ”¯æŒ</view>
        <image class="tip-qrcode" src="{{tipQrcodeUrl}}" mode="aspectFit" />
        <view class="tip-hint">é•¿æŒ‰è¯†åˆ«äºŒç»´ç æ‰“èµ</view>
        <view class="tip-close" bindtap="closeTipPopup">å…³é—­</view>
      </view>
    </view>

    <view class="bottom-spacer"></view>
  </scroll-view>
</view>
